(function(spj, $, undefined) {
	spj.registerTagClick = function() {
		$('#taglist ul li span').on("click", function(){
			addTagToInput(this.innerHTML, "renametag_old");
			addTagToInput(this.innerHTML, "deletetag_name");
			addTagToInput(this.innerHTML, "addtag_match");
		});
	};

	spj.registerAjaxNav = function() {
		$(".navigation a").click(function() {
			$("#tagslist").load(this.href, function(){
				spj.registerTagClick();
				spj.registerAjaxNav();
			});
			return false;
		});
	};

	function addTagToInput(tag, name_element) {
		var input_element = document.getElementById(name_element);

		if (input_element.value != '' && input_element.value.length > 0 && !input_element.value.match(/,\s*$/))
			input_element.value += ", ";

		var comma = new RegExp(tag + ",");
		if (!input_element.value.match(comma))
			input_element.value += tag + ", ";
		return true;
	}
}(window.spj = window.spj || {}, jQuery));
